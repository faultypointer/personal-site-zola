<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="light dark" name=color-scheme><title>Markov Chain</title><meta content='<h2 id="what-is-a-markov-chain">What is a Markov Chain?</h2>
<p>A Markov Chain is a mathematical model that describes a sequence of possible events, where the probability of each event is only dependent on the previous event.</p>
' name=description><link href=/img/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/img/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/img/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://fonts.googleapis.com rel=preconnect><link href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&family=Jost&display=swap" rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css rel=stylesheet><link href=/css/var.css rel=stylesheet><link href=/css/base.css rel=stylesheet><link href=/css/header.css rel=stylesheet><link href=/css/footer.css rel=stylesheet><link href=/css/post.css rel=stylesheet><body><script>if(localStorage.getItem('theme')=='dark'){document.body.classList.add('dark-mode');}</script><header class=blur><div class=top><a class="header blog" href=/blog><i class="ri-quill-pen-line ri-2x"></i><span>Blog</span></a><a class=back href=/><i class="ri-arrow-left-s-line ri-1x"></i><span>Home</span></a><div class=icon><a aria-label=home href=/ id=go-home><i class="ri-user-6-line ri-xl"></i></a><a aria-label="rss feed" href=/blog/feed.xml><i class="ri-rss-line ri-xl"></i></a><button aria-label="dark light mode switch" id=color-toggle><i class="ri-moon-line ri-xl"></i></button><button aria-label="table of content" id=toc-toggle><i class="ri-menu-2-line ri-xl"></i></button></div></div><div id=progress-bar></div></header><div class=wrap><div class=blank></div><main><div id=top></div><article><h1>Markov Chain</h1><div id=post-info><div class=date><span id=publish>2023-01-12</span></div><div class=tags><a class=tag href=https://faultypointer.netlify.app/tags/a-bite-of><i class="ri-hashtag ri-sm"></i><span>A bite of</span></a><a class=tag href=https://faultypointer.netlify.app/tags/python><i class="ri-hashtag ri-sm"></i><span>python</span></a><a class=tag href=https://faultypointer.netlify.app/tags/ai><i class="ri-hashtag ri-sm"></i><span>ai</span></a><a class=tag href=https://faultypointer.netlify.app/tags/markov-chain><i class="ri-hashtag ri-sm"></i><span>markov chain</span></a></div></div><blockquote class="note hidden" data-text1="Note: This article was last updated " data-text2=" days ago and may be out of date." data-days=120 id=outdate_warn><i class="ri-alarm-warning-line ri-lg"></i><span></span></blockquote><h2 id=what-is-a-markov-chain>What is a Markov Chain?</h2><p>A Markov Chain is a mathematical model that describes a sequence of possible events, where the probability of each event is only dependent on the previous event.</p><span id=continue-reading></span><h2 id=example>Example</h2><p>Suppose there are two states are A and B. At time 0, the system starts in state A. At each time step, there is a probability of 0.7 that the system will stay in state A, and a probability of 0.3 that it will transition to state B. If the system is in state B, there is a probability of 0.4 that it will stay in state B, and a probability of 0.6 that it will transition back to state A.<p>Here, the state transition diagram looks like this</p><img height=350, src=/res/blogs/markov_eg.svg width=350><p>So, you can see that the probabilities of transitioning from one state to another are fixed, and depend only on the current state.<h2 id=ai-minem-my-attempt-at-markov-chain>Ai-minem: My attempt at Markov Chain</h2><p>It is the simplest form of markov chain. What I did was take a bunch of lyrics of eminem's song and use it to train a model then had the model spit out a rap. Lets go through the project:<h3 id=collecting-data>Collecting Data</h3><p>I used requests to get the html data of the lyrics page and beautifulsoup4 to parse the data.<pre class=language-python data-lang=python style=background-color:#2e3440;color:#d8dee9;><code class=language-python data-lang=python><span>lyric </span><span style=color:#81a1c1;>= </span><span style=color:#a3be8c;>""
</span><span>res </span><span style=color:#81a1c1;>= </span><span>requests</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>get</span><span>(url)
</span><span>page </span><span style=color:#81a1c1;>= </span><span style=color:#88c0d0;>BeautifulSoup</span><span>(res</span><span style=color:#81a1c1;>.</span><span>content</span><span style=color:#eceff4;>, </span><span style=color:#a3be8c;>"html.parser"</span><span>)
</span><span style=color:#81a1c1;>for </span><span>div </span><span style=color:#81a1c1;>in </span><span>page</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>find_all</span><span>(attrs</span><span style=color:#81a1c1;>=</span><span>{</span><span style=color:#a3be8c;>"class"</span><span style=color:#eceff4;>: </span><span style=color:#a3be8c;>"Lyrics__Container-sc-1ynbvzw-6"</span><span>}):
</span><span>    </span><span style=color:#81a1c1;>for </span><span>link </span><span style=color:#81a1c1;>in </span><span>div</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>find_all</span><span>(</span><span style=color:#a3be8c;>"a"</span><span>):
</span><span>        lyric </span><span style=color:#81a1c1;>+= </span><span>link</span><span style=color:#81a1c1;>.</span><span>text</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>strip</span><span>()
</span><span>        lyric </span><span style=color:#81a1c1;>+= </span><span style=color:#a3be8c;>"</span><span style=color:#ebcb8b;>\n</span><span style=color:#a3be8c;>"
</span></code></pre><h3 id=markov-model>Markov Model</h3><p>Markov model is a class with members data and chain. Data is used to store the training data and chain is used to store the array of words that come after the current word.<pre class=language-python data-lang=python style=background-color:#2e3440;color:#d8dee9;><code class=language-python data-lang=python><span style=color:#81a1c1;>class </span><span style=color:#8fbcbb;>Markov</span><span>:
</span><span>    </span><span style=color:#81a1c1;>def </span><span style=color:#88c0d0;>__init__</span><span>(self) </span><span style=color:#eceff4;>-> </span><span style=color:#81a1c1;>None</span><span>:
</span><span>    </span><span style=color:#81a1c1;>self.</span><span>data </span><span style=color:#81a1c1;>= </span><span>[]
</span><span>    </span><span style=color:#81a1c1;>self.</span><span>chain </span><span style=color:#81a1c1;>= </span><span>{}
</span><span>
</span><span>    </span><span style=color:#81a1c1;>def </span><span style=color:#88c0d0;>add_data</span><span>(self</span><span style=color:#eceff4;>, </span><span>data) </span><span style=color:#eceff4;>-> </span><span style=color:#81a1c1;>None</span><span>:
</span><span>        </span><span style=color:#81a1c1;>...
</span><span>    </span><span style=color:#81a1c1;>def </span><span style=color:#88c0d0;>train</span><span>(self):
</span><span>        </span><span style=color:#81a1c1;>...
</span><span>    </span><span style=color:#81a1c1;>def </span><span style=color:#88c0d0;>spit_bars</span><span>(self</span><span style=color:#eceff4;>, </span><span>n</span><span style=color:#81a1c1;>=</span><span style=color:#b48ead;>100</span><span>):
</span><span>        </span><span style=color:#81a1c1;>...
</span><span>        
</span></code></pre><h3 id=training-the-markov-model>Training the Markov Model</h3><p>The data I collected are array of strings where single string is the whole lyrics of a song. For training the model, I looped through each string(lyrics) and used regex to find all the words in that lyrics. Then for each word, I saved the words that come after it in the <em>chain</em> member.<pre class=language-python data-lang=python style=background-color:#2e3440;color:#d8dee9;><code class=language-python data-lang=python><span style=color:#81a1c1;>def </span><span style=color:#88c0d0;>train</span><span>(self):
</span><span>    </span><span style=color:#81a1c1;>for </span><span>text </span><span style=color:#81a1c1;>in self.</span><span>data:
</span><span>        words </span><span style=color:#81a1c1;>= </span><span>re</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>findall</span><span>(</span><span style=color:#81a1c1;>r</span><span style=color:#a3be8c;>'\w</span><span style=color:#81a1c1;>+</span><span style=color:#a3be8c;>'</span><span style=color:#eceff4;>, </span><span>text)
</span><span>        </span><span style=color:#81a1c1;>for </span><span>(i</span><span style=color:#eceff4;>, </span><span>word) </span><span style=color:#81a1c1;>in </span><span style=font-style:italic;color:#88c0d0;>enumerate</span><span>(words[</span><span style=color:#eceff4;>:</span><span style=font-style:italic;color:#88c0d0;>len</span><span>(words)</span><span style=color:#81a1c1;>-</span><span style=color:#b48ead;>1</span><span>]):
</span><span>            </span><span style=color:#81a1c1;>if </span><span>word </span><span style=color:#81a1c1;>in self.</span><span>chain:
</span><span>                </span><span style=color:#81a1c1;>self.</span><span>chain[word]</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>append</span><span>(words[i</span><span style=color:#81a1c1;>+</span><span style=color:#b48ead;>1</span><span>])
</span><span>            </span><span style=color:#81a1c1;>else</span><span>:
</span><span>                </span><span style=color:#81a1c1;>self.</span><span>chain[word] </span><span style=color:#81a1c1;>= </span><span>[]
</span></code></pre><h3 id=spitting-bars>Spitting Bars</h3><p>Using the model to produce the lyrics is done through spit_bars function. It takes one optional argument, n, which denotes the number of words to produce. First, it selects a random word from the dictionary and saves it in the current variable. Then it loops n times, each time printing the current variable. Then it gets the list of possible choices using the current word as key from the chain dictionary. If the possible choices array is an empty, then all the keys from the dictionary become the possible choices. Then it sets the value of current to random word from possible choices and repeat.<pre class=language-python data-lang=python style=background-color:#2e3440;color:#d8dee9;><code class=language-python data-lang=python><span style=color:#81a1c1;>def </span><span style=color:#88c0d0;>spit_bars</span><span>(self</span><span style=color:#eceff4;>, </span><span>n</span><span style=color:#81a1c1;>=</span><span style=color:#b48ead;>100</span><span>):
</span><span>    default_choices </span><span style=color:#81a1c1;>= list</span><span>(</span><span style=color:#81a1c1;>self.</span><span>chain</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>keys</span><span>())
</span><span>    current </span><span style=color:#81a1c1;>= </span><span>random</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>choice</span><span>(default_choices)
</span><span>    i </span><span style=color:#81a1c1;>= </span><span style=color:#b48ead;>1
</span><span>    </span><span style=color:#81a1c1;>while </span><span>i </span><span style=color:#81a1c1;><= </span><span>n:
</span><span>        </span><span style=color:#81a1c1;>if </span><span>i </span><span style=color:#81a1c1;>% </span><span style=color:#b48ead;>15 </span><span style=color:#81a1c1;>== </span><span style=color:#b48ead;>0</span><span>:
</span><span>            </span><span style=font-style:italic;color:#88c0d0;>print</span><span>(</span><span style=color:#a3be8c;>""</span><span>)
</span><span>        </span><span style=font-style:italic;color:#88c0d0;>print</span><span>(current</span><span style=color:#eceff4;>, </span><span>end</span><span style=color:#81a1c1;>=</span><span style=color:#a3be8c;>" "</span><span>)
</span><span>        </span><span style=color:#81a1c1;>try</span><span>:
</span><span>            choices </span><span style=color:#81a1c1;>= self.</span><span>chain[current]
</span><span>        </span><span style=color:#81a1c1;>except </span><span style=color:#8fbcbb;>KeyError</span><span>:
</span><span>            choices </span><span style=color:#81a1c1;>= </span><span>default_choices
</span><span>        
</span><span>        </span><span style=color:#81a1c1;>if </span><span>choices:
</span><span>            current </span><span style=color:#81a1c1;>= </span><span>random</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>choice</span><span>(choices)
</span><span>        </span><span style=color:#81a1c1;>else</span><span>:
</span><span>            current </span><span style=color:#81a1c1;>= </span><span>random</span><span style=color:#81a1c1;>.</span><span style=color:#88c0d0;>choice</span><span>(default_choices)            
</span><span>        i</span><span style=color:#81a1c1;>+=</span><span style=color:#b48ead;>1
</span><span>    </span><span style=font-style:italic;color:#88c0d0;>print</span><span>(</span><span style=color:#a3be8c;>""</span><span>)
</span></code></pre><h3 id=output>Output</h3><p>The markov model produced this output after training with 5 eminem's songs lyrics.<pre style=background-color:#2e3440;color:#d8dee9;><code><span>suffer Kneel autumn Spider throatin above missed This flippity type of money capI Made 
</span><span>bigger help your concert heart readyTo cheese dope Bill truthful throat spray and shoot ya 
</span><span>bombs fact this hole momentWould RakimLakim killed attack Fat are so bad it s a 
</span><span>Doberman us to choke move like to a lifetime yoYou better never let it was 
</span><span>a catchy heavyThere old in commonWe are hungry I got them uppers looks superstardom knees 
</span><span>flippity reason is drop bombs explosions the trailer s all in the blueprint ma sleep 
</span><span>and on the trunkBut 2004 Think gone cold I put em with your partners feet 
</span><span>Did idolHe while he won t see at all And here s not miss your 
</span><span>ass disastrously killers Make maxi pad Evil cut your mind to set your headSo talk 
</span><span>rubber slip Pharoahe paraplegic the front to fuse audience totterCaught toward honestBut jealous While an 
</span><span>MC realized fall positionTo May back pocket tongues These hoes is gaping f inadvertently arsenal 
</span><span>chips forgot really got You don t know how much we re sayin face lookin 
</span><span>boy cause I ve got some And even been up you scream which six years 
</span><span>finna kill himself carry figure outHow to tell me to the fuck that anything you 
</span><span>already know the Air Breezy lead Apache add jointsProlly burst at the fuck it s 
</span><span>how much we have arms are over some bitch I could it life for sure 
</span><span>you re cut your posters use sublim problem lose yourself like to feel like Apache 
</span><span>Collins together think I m Back cold product of me know there to bite aStrap 
</span><span>Up on Cause I m a product They moved Glock capableOf openMy stacked rarely Syllables 
</span><span>read phat soldierTongue Get outta those days t utilize murderers or shot do thoughFor way 
</span><span>to come at me do not miss your Gang Like you better lose yourself in 
</span><span>a couple of RakimLakim jot reminds me like a pile 9See dawg room yackety ago 
</span><span>helps voices vodka you better lose yourself like his tough demeanourSo songsSo buggin tGive caught 
</span><span>lemons dah dah dah dah You re never asked change It s my family IGot 
</span><span>out Chorus Dido My tea s how much it only grows hotter if I m 
</span><span>beginnin to the flowsAnd B Up on her throat spray and Audemars jointsProlly Mom capture 
</span><span>this is such swallow huh This little brother I can t breathe genital comin at 
</span><span>me outside cornrows spot myself cause I ain t utilize Jordans ma name across coaster 
</span><span>lead Syllables was a costly beginning along truthful finna kill you can t batter GoldmanI 
</span><span>Slim I did that made itSo insult matter ColumbinePut fatal N9neIf wondering why IGot out 
</span><span>like a time Shady you tell me notThis flippity sendin answer all hell yeah from 
</span><span>your nose dove venom pull Bizarre after Mya said on my life And what I 
</span><span>can barely knows his name was youDamn amplified skunk talk calm trunk white gotta dance 
</span><span>long as fuck that s how 
</span></code></pre><h2 id=what-s-next>What's next?</h2><p>I plan to make it so that instead of using just one word as a determining factor for the next word, it uses maybe 3 or 4 previous words to do so. I also want to use neural network or ML algorithm. Although I will probably forget about this since I started working on another project.<p>That's it for today, see you in next blog.<blockquote class=note id=cc_license><i class="ri-creative-commons-line ri-lg"></i><div class=content><p>This work is licensed under <a rel="nofollow noreferrer" href=http://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a>.</div></blockquote></article></main><aside class=blur><nav><ul><li><a class=toc-h2 href=#what-is-a-markov-chain>What is a Markov Chain?</a><li><a class=toc-h2 href=#example>Example</a><li><a class=toc-h2 href=#ai-minem-my-attempt-at-markov-chain>Ai-minem: My attempt at Markov Chain</a> <ul><li><a class=toc-h3 href=#collecting-data>Collecting Data</a><li><a class=toc-h3 href=#markov-model>Markov Model</a><li><a class=toc-h3 href=#training-the-markov-model>Training the Markov Model</a><li><a class=toc-h3 href=#spitting-bars>Spitting Bars</a><li><a class=toc-h3 href=#output>Output</a></ul><li><a class=toc-h2 href=#what-s-next>What's next?</a></ul></nav><a aria-label="back to top" href=#top id=back-to-top><i class="ri-arrow-up-s-line ri-2x"></i></a></aside></div><footer><div class=copyright>Copyright © 2022 faultypointer. All rights reserved.</div><div class=credits><span>Powered by <a rel="noreferrer noopener" href=https://www.getzola.org/ target=_blank>Zola</a> and <a rel="noreferrer noopener" href=https://github.com/isunjn/serene target=_blank>Serene</a></span></div></footer><script src=/js/dark.js></script><script src=/js/outdate.js></script><script src=/js/toc.js></script><script src=/js/progress.js></script><script src=/js/lightense.min.js></script><script src=/js/img.js></script>